<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Focus Mode</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            margin: 0;
            padding: 0
        }

        .focus-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2)
        }

        .focus-wrapper {
            max-width: 1200px;
            width: 100%
        }

        .focus-header {
            text-align: center;
            margin-bottom: 30px
        }

        .focus-header h1 {
            font-size: 2.5rem;
            margin: 0 0 15px;
            color: #fff
        }

        .focus-task-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: rgba(255, 255, 255, .9);
            margin-bottom: 10px
        }

        .focus-task-priority {
            display: inline-block;
            padding: 6px 18px;
            border-radius: 20px;
            font-size: .9rem;
            font-weight: 600
        }

        .priority-critical {
            background: linear-gradient(135deg, #f093fb, #f5576c)
        }

        .priority-high {
            background: linear-gradient(135deg, #fa709a, #fee140)
        }

        .priority-medium {
            background: linear-gradient(135deg, #ffecd2, #fcb69f)
        }

        .priority-low {
            background: linear-gradient(135deg, #a8edea, #fed6e3)
        }

        .focus-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px
        }

        @media(max-width:900px) {
            .focus-grid {
                grid-template-columns: 1fr
            }
        }

        .timer-col,
        .music-col {
            padding: 30px;
            background: rgba(255, 255, 255, .08);
            border-radius: 20px;
            backdrop-filter: blur(10px)
        }

        .timer-display {
            font-size: 5.5rem;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            color: #fff;
            text-align: center;
            margin: 40px 0;
            text-shadow: 0 4px 25px rgba(0, 0, 0, .5);
            letter-spacing: .08em
        }

        .timer-controls {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap
        }

        .timer-btn {
            padding: 14px 32px;
            font-size: 1rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all .3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, .25);
            color: #fff
        }

        .timer-btn.start {
            background: linear-gradient(135deg, #667eea, #764ba2)
        }

        .timer-btn.pause {
            background: linear-gradient(135deg, #f093fb, #f5576c)
        }

        .timer-btn.stop {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f)
        }

        .timer-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, .35)
        }

        .timer-btn:disabled {
            opacity: .5;
            cursor: not-allowed
        }

        .music-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 18px;
            color: #fff;
            text-align: center
        }

        .music-select {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, .25);
            background: rgba(255, 255, 255, .15);
            color: #fff;
            font-size: 1rem;
            margin-bottom: 18px;
            cursor: pointer
        }

        .music-select option,
        .music-select optgroup {
            background: #2d3748;
            color: #fff
        }

        .youtube-container {
            width: 100%;
            height: 315px;
            border-radius: 12px;
            overflow: hidden;
            display: none;
            box-shadow: 0 8px 25px rgba(0, 0, 0, .3)
        }

        .youtube-container.active {
            display: block
        }

        .stats-bottom {
            margin-top: 25px;
            padding: 25px;
            background: rgba(255, 255, 255, .08);
            border-radius: 20px;
            text-align: center
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px
        }

        @media(max-width:600px) {
            .stats-grid {
                grid-template-columns: 1fr
            }
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #fff
        }

        .stat-label {
            font-size: .95rem;
            color: rgba(255, 255, 255, .7);
            margin-top: 6px
        }

        .back-btn {
            margin-top: 20px;
            padding: 12px 35px;
            background: rgba(255, 255, 255, .2);
            border: 2px solid rgba(255, 255, 255, .3);
            border-radius: 50px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: all .3s;
            display: inline-block
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, .3);
            transform: translateY(-2px)
        }
    </style>
</head>

<body>
    <div class="focus-container">
        <div class="focus-wrapper">
            <div class="focus-header">
                <h1>üéØ Focus Mode</h1>
                <div class="focus-task-title" id="taskTitle">Loading...</div>
                <div class="focus-task-priority" id="taskPriority"></div>
            </div>
            <div class="focus-grid">
                <div class="timer-col">
                    <div class="timer-display" id="timerDisplay">25:00</div>
                    <div class="timer-controls">
                        <button class="timer-btn start" id="startBtn" onclick="focusApp.start()">‚ñ∂Ô∏è Start</button>
                        <button class="timer-btn pause" id="pauseBtn" onclick="focusApp.pause()" disabled>‚è∏Ô∏è
                            Pause</button>
                        <button class="timer-btn stop" id="stopBtn" onclick="focusApp.stop()" disabled>‚èπÔ∏è Stop</button>
                    </div>
                </div>
                <div class="music-col">
                    <div class="music-title">üéµ Study Music</div>
                    <select class="music-select" id="musicSelect" onchange="focusApp.changeMusic()">
                        <option value="">-- Kh√¥ng nh·∫°c --</option>
                        <optgroup label="üáªüá≥ Vietnamese Lofi">
                            <option value="8EdLx2Jg6LQ">üéµ Nh·∫°c Lofi Chill Bu·ªìn</option>
                            <option value="F3W6WW_dmPo">üíï Lofi Vi·ªát Mix C·ª±c Chill</option>
                            <option value="tVj0ZTS4WF4">üåô Nh·∫°c Lofi Vi·ªát Tuy·ªÉn Ch·ªçn</option>
                            <option value="dCkzcu0fLjw">üéß Top Lofi Vi·ªát Th·ªãnh H√†nh</option>
                            <option value="ZaznM7wN6bk">üå∏ Lofi Vi·ªát Nh·∫π Nh√†ng</option>
                            <option value="AcxlCIFOQRo">‚òï Lofi Vi·ªát H·ªçc B√†i L√†m Vi·ªác</option>
                        </optgroup>
                        <optgroup label="üéß International Lofi">
                            <option value="jfKfPfyJRdk">Lofi Girl - Study/Relax 24/7</option>
                            <option value="lTRiuFIWV54">Lofi Girl - Sleep/Chill</option>
                            <option value="4xDzrJKXOOY">Lofi Cafe - Coffee Jazz</option>
                        </optgroup>
                        <optgroup label="üåßÔ∏è Nature">
                            <option value="eKFTSSKCzWA">Rain & Thunder</option>
                            <option value="q76bMs-NwRk">Ocean Waves</option>
                            <option value="na61TF0jKKU">Fireplace</option>
                        </optgroup>
                        <optgroup label="üéπ Instrumental">
                            <option value="2OEL4P1Rz04">Piano Relaxing</option>
                            <option value="SJwRkKRSwJM">Classical Music</option>
                            <option value="fEvM-OUbaKs">Smooth Jazz</option>
                        </optgroup>
                    </select>
                    <div id="youtubeContainer" class="youtube-container"></div>
                </div>
            </div>
            <div class="stats-bottom">
                <div class="stats-grid">
                    <div>
                        <div class="stat-value" id="sessionsToday">0</div>
                        <div class="stat-label">Sessions</div>
                    </div>
                    <div>
                        <div class="stat-value" id="focusTimeToday">0h</div>
                        <div class="stat-label">Focus Time</div>
                    </div>
                    <div>
                        <div class="stat-value" id="completedTasks">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                </div>
                <button class="back-btn" onclick="window.location.href='index.html'">‚Üê Quay l·∫°i danh s√°ch</button>
            </div>
        </div>
    </div>
    <script type="module">
        import authService from './firebase-auth.js';
        class FocusApp { constructor() { this.task = null; this.timeRemaining = 0; this.isRunning = false; this.isPaused = false; this.interval = null; this.init() } async init() { await authService.waitForAuth(); if (!authService.isLoggedIn()) { window.location.href = 'login.html'; return } this.loadTask(); this.loadStats() } loadTask() { const d = sessionStorage.getItem('focusTask'); if (!d) { alert('Kh√¥ng t√¨m th·∫•y task'); window.location.href = 'index.html'; return } this.task = JSON.parse(d); document.getElementById('taskTitle').textContent = this.task.title; const p = document.getElementById('taskPriority'); p.textContent = this.task.priority.toUpperCase(); p.className = `focus-task-priority priority-${this.task.priority}`; this.timeRemaining = this.task.estimatedTime * 60; this.updateDisplay() } loadStats() { const s = JSON.parse(localStorage.getItem('focusStats') || '{"sessions":0,"totalTime":0,"completedTasks":0}'); const t = new Date().toDateString(); const ts = JSON.parse(localStorage.getItem(`focusStats_${t}`) || '{"sessions":0,"totalTime":0}'); document.getElementById('sessionsToday').textContent = ts.sessions; document.getElementById('focusTimeToday').textContent = (ts.totalTime / 60).toFixed(1) + 'h'; document.getElementById('completedTasks').textContent = s.completedTasks } start() { if (this.isRunning) return; this.isRunning = true; this.isPaused = false; document.getElementById('startBtn').disabled = true; document.getElementById('pauseBtn').disabled = false; document.getElementById('stopBtn').disabled = false; this.interval = setInterval(() => { if (this.timeRemaining > 0) { this.timeRemaining--; this.updateDisplay() } else { this.complete() } }, 1000) } pause() { if (!this.isRunning) return; this.isPaused = !this.isPaused; if (this.isPaused) { clearInterval(this.interval); document.getElementById('pauseBtn').textContent = '‚ñ∂Ô∏è Resume' } else { this.start(); document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è Pause' } } stop() { if (!confirm('D·ª´ng focus session?')) return; this.isRunning = false; this.isPaused = false; clearInterval(this.interval); document.getElementById('startBtn').disabled = false; document.getElementById('pauseBtn').disabled = true; document.getElementById('stopBtn').disabled = true; document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è Pause'; this.timeRemaining = this.task.estimatedTime * 60; this.updateDisplay() } complete() { clearInterval(this.interval); alert(`üéâ Ho√†n th√†nh! B·∫°n ƒë√£ focus ${this.task.estimatedTime} ph√∫t!`); this.updateStats(this.task.estimatedTime); if (confirm('Quay l·∫°i danh s√°ch?')) window.location.href = 'index.html'; else this.stop() } updateStats(m) { const t = new Date().toDateString(); const ts = JSON.parse(localStorage.getItem(`focusStats_${t}`) || '{"sessions":0,"totalTime":0}'); ts.sessions++; ts.totalTime += m; localStorage.setItem(`focusStats_${t}`, JSON.stringify(ts)); this.loadStats() } updateDisplay() { const m = Math.floor(this.timeRemaining / 60); const s = this.timeRemaining % 60; document.getElementById('timerDisplay').textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}` } changeMusic() { const sel = document.getElementById('musicSelect'); const cont = document.getElementById('youtubeContainer'); if (!sel.value) { cont.classList.remove('active'); cont.innerHTML = ''; return } cont.classList.add('active'); cont.innerHTML = `<iframe width="100%" height="315" src="https://www.youtube.com/embed/${sel.value}?autoplay=0&controls=1&modestbranding=1&rel=0" frameborder="0" allow="accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture" allowfullscreen></iframe>` } } const focusApp = new FocusApp(); window.focusApp = focusApp;
    </script>
</body>

</html>